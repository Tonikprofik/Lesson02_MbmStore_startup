@addTagHelper "*, Microsoft.AspNetCore.Mvc.TagHelpers"
@using MbmStore.Models;
@{
    ViewData["Title"] = "Invoice";
}

<h1>Invoice</h1>
<a asp-controller="Home" asp-action="Index">Home</a>
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
</head>

<body>

    <form asp-action="index" method="post" asp-controller="Invoice">
        <div>
            <select name="customer" id="customer"
                    asp-items="@ViewData["Customers"] 
                    as List<SelectListItem>"></select>
            <button type ="submit">Show invoices</button>
         </div>
    </form>

    <table>
        <tr>
            <th>Customer</th>
            <th>Product</th>
            <th>Price</th>
            <th>Sum</th>
        </tr>

        @foreach (Invoice invoice in ViewBag.Invoices)
        {
            <tr>
                <td>
                    @invoice.Customer.LastName
                    @invoice.Customer.FirstName
                </td>

                
            @foreach (OrderItem orderItem in invoice.OrderItems)
              {
                <tr><td></td> 
                <td>@orderItem.Product.Title</td> 
                <td>@orderItem.Product.Price</td> 
                <td>@orderItem.TotalPrice</td> 
                </tr>      
              }
                
            </tr>
         }
    </table>

</body>
</html>
